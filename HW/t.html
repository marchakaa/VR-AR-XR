<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script type="importmap">
        {
			"imports": {
			  "three": "https://unpkg.com/three@0.161.0/build/three.module.js",
			  "three/addons/": "https://unpkg.com/three@0.161.0/examples/jsm/",
			  "vax": "https://boytchev.github.io/CourseVAX/lib/vax.js"
		    }
		}
    </script>
    
</head>
<body>
    <script type="module">
        import * as THREE from 'three';
        import {vaxInit, scene} from 'vax';
        vaxInit(frame);
        scene.background = new THREE.Color().setHSL(0.5, 0.5, 0.5);

        let floor = new THREE.Mesh(new THREE.BoxGeometry(500, 2, 500), new THREE.MeshBasicMaterial({color: 'green'}));
        floor.position.y = -30;
        scene.add(floor);

        let bear = new THREE.Group();
        scene.add(bear);
        let bearMaterial = new THREE.MeshPhongMaterial({color: 'brown'});

        let body = new THREE.Mesh(new THREE.BoxGeometry(12, 15, 12), bearMaterial);
        let tummy = new THREE.Mesh(new THREE.BoxGeometry(10, 13, 0.1), new THREE.MeshPhongMaterial({color: "lightbrown"}));
        tummy.position.z = 6;

        let bearHead = new THREE.Group();
        // bearHead.rotation.x -= Math.PI/2;
        bearHead.position.y = 10;

        let face = new THREE.Mesh(new THREE.BoxGeometry(8, 8, 8), bearMaterial);
        bearHead.add(face);
        for (let index = 0; index < 2; index++) {
            let eye = new THREE.Mesh(new THREE.CylinderGeometry(0.75, 0.75, 0.1, 32, 16), new THREE.MeshPhongMaterial({color: 'black'}));
            eye.rotation.x += Math.PI/2;
            eye.position.set(2*Math.pow(-1, index), 2, 4);
            bearHead.add(eye);            
        }
        for (let index = 0; index < 2; index++) {
            let ear = new THREE.Mesh(new THREE.CylinderGeometry(1.5, 1.5, 1, 32, 16), bearMaterial);
            ear.rotation.x += Math.PI/2;
            ear.position.set(4*Math.pow(-1, index), 4, 0);
            bearHead.add(ear);
            let innerEar = new THREE.Mesh(new THREE.CylinderGeometry(1, 1, 0.1, 32, 16), new THREE.MeshPhongMaterial({color: 'lightbrown'}));
            innerEar.rotation.x += Math.PI/2;
            innerEar.position.set(4*Math.pow(-1, index), 4, 0.5);
            bearHead.add(innerEar);
        }
        let mouth = new THREE.Mesh(new THREE.CylinderGeometry(1, 1, 0.1, 32, 16), new THREE.MeshPhongMaterial({color: 'lightbrown'}));
        mouth.scale.set(1.5, 1, 1);
        mouth.rotation.x += Math.PI/2;
        mouth.position.set(0, -0.5, 4);
        bearHead.add(mouth);
        let mouthLine = new THREE.Mesh(new THREE.BoxGeometry(2, 0.3, 0.1), new THREE.MeshPhongMaterial({color: 'black'}));
        mouthLine.position.set(0, -0.7,4.01);
        bearHead.add(mouthLine);
        mouthLine = new THREE.Mesh(new THREE.BoxGeometry(0.3, 0.8, 0.1), new THREE.MeshPhongMaterial({color: 'black'}));
        mouthLine.position.set(0, -0.1, 4.01);
        bearHead.add(mouthLine);
        let nose = new THREE.Mesh(new THREE.SphereGeometry(1, 32, 16), new THREE.MeshPhongMaterial({color: 'black'}));
        nose.rotation.x += Math.PI/2;
        nose.scale.x = 1.3;
        nose.position.set(0, 1, 3.3);
        bearHead.add(nose);

        let leg = new THREE.Group();
        for (let index = 0; index < 4; index++) {
            let mainLeg = new THREE.Mesh(new THREE.BoxGeometry(4, 4, 12), bearMaterial);
            mainLeg.rotation.z += Math.PI/2;
            mainLeg.position.set(8*Math.pow(-1, index), 5*Math.pow(-1, Math.floor(index/2)), 3);
            leg.add(mainLeg);
        }


        bear.add(body, tummy, bearHead, leg);
        function frame(t) {
            bear.rotation.y = t/5;
        }
    </script>    
</body>
</html>